<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Shape files | SDMs - Trillium Example</title>
  <meta name="description" content="Example scripts for building SDMs for a terrestrial plant species." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Shape files | SDMs - Trillium Example" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/logo.png" />
  <meta property="og:description" content="Example scripts for building SDMs for a terrestrial plant species." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Shape files | SDMs - Trillium Example" />
  
  <meta name="twitter:description" content="Example scripts for building SDMs for a terrestrial plant species." />
  <meta name="twitter:image" content="images/logo.png" />

<meta name="author" content="E. E. Holmes" />


<meta name="date" content="2020-08-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="trillium.html"/>
<link rel="next" href="observation-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">SDM Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="trillium.html"><a href="trillium.html"><i class="fa fa-check"></i><b>1</b> Trillium</a></li>
<li class="chapter" data-level="2" data-path="shape-files.html"><a href="shape-files.html"><i class="fa fa-check"></i><b>2</b> Shape files</a></li>
<li class="chapter" data-level="3" data-path="observation-data.html"><a href="observation-data.html"><i class="fa fa-check"></i><b>3</b> Observation data</a></li>
<li class="chapter" data-level="4" data-path="variables.html"><a href="variables.html"><i class="fa fa-check"></i><b>4</b> Variables</a></li>
<li class="chapter" data-level="5" data-path="sdm-data-frame.html"><a href="sdm-data-frame.html"><i class="fa fa-check"></i><b>5</b> SDM Data Frame</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SDMs - Trillium Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="shape-files" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Shape files</h1>
<p>The first step is to define the spatial extent of the area you will be working with and set up any shape files you need to plot boundaries or polygons or mask out areas.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="shape-files.html#cb1-1"></a><span class="kw">library</span>(sp)</span>
<span id="cb1-2"><a href="shape-files.html#cb1-2"></a><span class="kw">library</span>(raster)</span>
<span id="cb1-3"><a href="shape-files.html#cb1-3"></a><span class="kw">library</span>(maps)</span>
<span id="cb1-4"><a href="shape-files.html#cb1-4"></a><span class="kw">library</span>(stringr)</span></code></pre></div>
<div id="create-the-boundary-box" class="section level2">
<h2><span class="header-section-number">2.1</span> Create the boundary box</h2>
<p>First I need to define an <code>raster::extent</code> object for a box bounding NH and VT. This will be used to crop the data that we download. I can get a bounding box dynamically using <code>drawExtent()</code>. Click twice (upper corner/lower corner) on the map to select the region of interest. Don’t go too far outside the lines.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="shape-files.html#cb2-1"></a>maps<span class="op">::</span><span class="kw">map</span>(<span class="st">&quot;state&quot;</span>, <span class="dt">region =</span> <span class="kw">c</span>(<span class="st">&quot;new hampshire&quot;</span>, <span class="st">&quot;vermont&quot;</span>, <span class="st">&quot;new york&quot;</span>, </span>
<span id="cb2-2"><a href="shape-files.html#cb2-2"></a>    <span class="st">&quot;massachusetts&quot;</span>))</span>
<span id="cb2-3"><a href="shape-files.html#cb2-3"></a>NHVT &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">drawExtent</span>()</span></code></pre></div>
<p>or I can use longitude/latitude values for the box and use <code>extent()</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="shape-files.html#cb3-1"></a>NHVT &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">extent</span>(<span class="op">-</span><span class="fl">73.61056</span>, <span class="fl">-70.60205</span>, <span class="fl">42.48873</span>, <span class="fl">45.37969</span>)</span></code></pre></div>
</div>
<div id="get-the-states-shapefile" class="section level2">
<h2><span class="header-section-number">2.2</span> Get the states shapefile</h2>
<p>I download the shapefile for the NH and VT state borders using <code>getData()</code> which gives polygons for countries. Level 1 will be the state boundaries (I assume). The shape file has all the states. Then I use <code>subset()</code> to get the two states that I want. <code>path</code> says where to save the downloaded file.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="shape-files.html#cb4-1"></a>usashp &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">getData</span>(<span class="st">&quot;GADM&quot;</span>, <span class="dt">country =</span> <span class="st">&quot;USA&quot;</span>, <span class="dt">level =</span> <span class="dv">1</span>, </span>
<span id="cb4-2"><a href="shape-files.html#cb4-2"></a>    <span class="dt">path =</span> <span class="st">&quot;data&quot;</span>)</span>
<span id="cb4-3"><a href="shape-files.html#cb4-3"></a>nhvtshp &lt;-<span class="st"> </span><span class="kw">subset</span>(usashp, NAME_<span class="dv">1</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;New Hampshire&quot;</span>, <span class="st">&quot;Vermont&quot;</span>))</span>
<span id="cb4-4"><a href="shape-files.html#cb4-4"></a>nhshp &lt;-<span class="st"> </span><span class="kw">subset</span>(usashp, NAME_<span class="dv">1</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;New Hampshire&quot;</span>))</span>
<span id="cb4-5"><a href="shape-files.html#cb4-5"></a>vtshp &lt;-<span class="st"> </span><span class="kw">subset</span>(usashp, NAME_<span class="dv">1</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Vermont&quot;</span>))</span></code></pre></div>
<p>Check the projection for this shapefile:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="shape-files.html#cb5-1"></a><span class="kw">crs</span>(nhvtshp)</span></code></pre></div>
<pre><code>CRS arguments:
 +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 </code></pre>
<p>I can plot the shapes.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="shape-files.html#cb7-1"></a><span class="kw">plot</span>(nhvtshp, <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">axes =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-7-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="get-the-hubbard-brook-boundary" class="section level2">
<h2><span class="header-section-number">2.3</span> Get the Hubbard Brook boundary</h2>
<p>I downloaded this shapefile separately and read it in. This will get the boundary of the Hubbard Brook Experimental Forest from a shapefile. Although I write “shapefile” singular, it is actually two files, the shapefile and some metafiles. If you look in the <code>hbef_boundary</code> folder you’ll the metafiles.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="shape-files.html#cb8-1"></a>hbshp &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">shapefile</span>(<span class="st">&quot;data/hbef_boundary/hbef_boundary.shp&quot;</span>)</span></code></pre></div>
<p>I check its projection and note that it is different from the NH+VT shapefile.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="shape-files.html#cb9-1"></a><span class="kw">crs</span>(hbshp)</span></code></pre></div>
<pre><code>CRS arguments:
 +proj=utm +zone=19 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m
+no_defs </code></pre>
<p>I transform the shapefile to get it on the same projection.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="shape-files.html#cb11-1"></a>newcrs &lt;-<span class="st"> </span><span class="kw">crs</span>(nhvtshp)</span>
<span id="cb11-2"><a href="shape-files.html#cb11-2"></a>hbshp &lt;-<span class="st"> </span>sp<span class="op">::</span><span class="kw">spTransform</span>(hbshp, newcrs)</span></code></pre></div>
<p>Plot it.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="shape-files.html#cb12-1"></a><span class="kw">plot</span>(hbshp)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-the-boundaries-together" class="section level2">
<h2><span class="header-section-number">2.4</span> Plot the boundaries together</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="shape-files.html#cb13-1"></a><span class="kw">plot</span>(nhvtshp, <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">axes =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-2"><a href="shape-files.html#cb13-2"></a><span class="kw">plot</span>(hbshp, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-3"><a href="shape-files.html#cb13-3"></a><span class="kw">text</span>(<span class="op">-</span><span class="fl">71.8</span>, <span class="dv">44</span>, <span class="st">&quot;HBEF&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-12-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="save" class="section level2">
<h2><span class="header-section-number">2.5</span> Save</h2>
<p>I save the shapefile data to a file so I can use it later without rerunning this code.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="shape-files.html#cb14-1"></a><span class="kw">save</span>(nhvtshp, hbshp, nhshp, vtshp, NHVT, <span class="dt">file =</span> <span class="st">&quot;data/shapefiles.RData&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="trillium.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="observation-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/eeholmes/Species-Dist-Modeling---Trillium/edit/master/02_Shapefiles.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["sdm-demo.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
