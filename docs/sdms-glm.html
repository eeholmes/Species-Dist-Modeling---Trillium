<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 SDMs – GLM | SDMs - Trillium Example</title>
  <meta name="description" content="Example scripts for building SDMs for a terrestrial plant species." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 SDMs – GLM | SDMs - Trillium Example" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/logo.png" />
  <meta property="og:description" content="Example scripts for building SDMs for a terrestrial plant species." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 SDMs – GLM | SDMs - Trillium Example" />
  
  <meta name="twitter:description" content="Example scripts for building SDMs for a terrestrial plant species." />
  <meta name="twitter:image" content="images/logo.png" />

<meta name="author" content="E. E. Holmes" />


<meta name="date" content="2020-08-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="training-and-testing-data.html"/>
<link rel="next" href="sdms-gam.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">SDM Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#prequisite-knowledge"><i class="fa fa-check"></i><b>0.1</b> Prequisite knowledge</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#set-up---r-and-rstudio"><i class="fa fa-check"></i><b>0.2</b> Set-up - R and RStudio</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#get-the-shapefiles-for-hubbard-brook"><i class="fa fa-check"></i><b>0.3</b> Get the shapefiles for Hubbard Brook</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#set-up---r-packages"><i class="fa fa-check"></i><b>0.4</b> Set-up - R packages</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#data-downloads"><i class="fa fa-check"></i><b>0.5</b> Data downloads</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="trillium.html"><a href="trillium.html"><i class="fa fa-check"></i><b>1</b> Trillium</a></li>
<li class="chapter" data-level="2" data-path="shape-files.html"><a href="shape-files.html"><i class="fa fa-check"></i><b>2</b> Shape files</a><ul>
<li class="chapter" data-level="2.1" data-path="shape-files.html"><a href="shape-files.html#create-the-boundary-box"><i class="fa fa-check"></i><b>2.1</b> Create the boundary box</a></li>
<li class="chapter" data-level="2.2" data-path="shape-files.html"><a href="shape-files.html#get-the-states-shapefile"><i class="fa fa-check"></i><b>2.2</b> Get the states shapefile</a></li>
<li class="chapter" data-level="2.3" data-path="shape-files.html"><a href="shape-files.html#get-the-hubbard-brook-boundary"><i class="fa fa-check"></i><b>2.3</b> Get the Hubbard Brook boundary</a></li>
<li class="chapter" data-level="2.4" data-path="shape-files.html"><a href="shape-files.html#plot-the-boundaries-together"><i class="fa fa-check"></i><b>2.4</b> Plot the boundaries together</a></li>
<li class="chapter" data-level="2.5" data-path="shape-files.html"><a href="shape-files.html#save"><i class="fa fa-check"></i><b>2.5</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="observation-data.html"><a href="observation-data.html"><i class="fa fa-check"></i><b>3</b> Observation data</a><ul>
<li class="chapter" data-level="3.1" data-path="observation-data.html"><a href="observation-data.html#set-up"><i class="fa fa-check"></i><b>3.1</b> Set-up</a></li>
<li class="chapter" data-level="3.2" data-path="observation-data.html"><a href="observation-data.html#download-data"><i class="fa fa-check"></i><b>3.2</b> Download data</a></li>
<li class="chapter" data-level="3.3" data-path="observation-data.html"><a href="observation-data.html#check-the-coordinate-projection"><i class="fa fa-check"></i><b>3.3</b> Check the coordinate projection</a></li>
<li class="chapter" data-level="3.4" data-path="observation-data.html"><a href="observation-data.html#make-a-sp-object"><i class="fa fa-check"></i><b>3.4</b> Make a sp object</a></li>
<li class="chapter" data-level="3.5" data-path="observation-data.html"><a href="observation-data.html#check-for-inaccurate-location-data"><i class="fa fa-check"></i><b>3.5</b> Check for inaccurate location data</a></li>
<li class="chapter" data-level="3.6" data-path="observation-data.html"><a href="observation-data.html#plot"><i class="fa fa-check"></i><b>3.6</b> Plot</a></li>
<li class="chapter" data-level="3.7" data-path="shape-files.html"><a href="shape-files.html#save"><i class="fa fa-check"></i><b>3.7</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variables.html"><a href="variables.html"><i class="fa fa-check"></i><b>4</b> Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="observation-data.html"><a href="observation-data.html#set-up"><i class="fa fa-check"></i><b>4.1</b> Set-up</a></li>
<li class="chapter" data-level="4.2" data-path="variables.html"><a href="variables.html#climatic-data"><i class="fa fa-check"></i><b>4.2</b> Climatic data</a></li>
<li class="chapter" data-level="4.3" data-path="variables.html"><a href="variables.html#topographical-data"><i class="fa fa-check"></i><b>4.3</b> Topographical data</a></li>
<li class="chapter" data-level="4.4" data-path="variables.html"><a href="variables.html#land-cover-data"><i class="fa fa-check"></i><b>4.4</b> Land cover data</a></li>
<li class="chapter" data-level="4.5" data-path="variables.html"><a href="variables.html#stack-all-variables"><i class="fa fa-check"></i><b>4.5</b> Stack all variables</a></li>
<li class="chapter" data-level="4.6" data-path="variables.html"><a href="variables.html#fix-layer-names"><i class="fa fa-check"></i><b>4.6</b> Fix layer names</a></li>
<li class="chapter" data-level="4.7" data-path="variables.html"><a href="variables.html#fix-temperature-in-gbif"><i class="fa fa-check"></i><b>4.7</b> Fix temperature in GBIF</a></li>
<li class="chapter" data-level="4.8" data-path="shape-files.html"><a href="shape-files.html#save"><i class="fa fa-check"></i><b>4.8</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sdm-data-frame.html"><a href="sdm-data-frame.html"><i class="fa fa-check"></i><b>5</b> SDM Data Frame</a><ul>
<li class="chapter" data-level="5.1" data-path="observation-data.html"><a href="observation-data.html#set-up"><i class="fa fa-check"></i><b>5.1</b> Set-up</a></li>
<li class="chapter" data-level="5.2" data-path="sdm-data-frame.html"><a href="sdm-data-frame.html#variable-values-for-presences"><i class="fa fa-check"></i><b>5.2</b> Variable values for presences</a></li>
<li class="chapter" data-level="5.3" data-path="sdm-data-frame.html"><a href="sdm-data-frame.html#background-points"><i class="fa fa-check"></i><b>5.3</b> Background points</a></li>
<li class="chapter" data-level="5.4" data-path="sdm-data-frame.html"><a href="sdm-data-frame.html#make-final-data-frame"><i class="fa fa-check"></i><b>5.4</b> Make final data frame</a></li>
<li class="chapter" data-level="5.5" data-path="shape-files.html"><a href="shape-files.html#save"><i class="fa fa-check"></i><b>5.5</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="variable-correlation.html"><a href="variable-correlation.html"><i class="fa fa-check"></i><b>6</b> Variable Correlation</a><ul>
<li class="chapter" data-level="6.1" data-path="observation-data.html"><a href="observation-data.html#set-up"><i class="fa fa-check"></i><b>6.1</b> Set-up</a></li>
<li class="chapter" data-level="6.2" data-path="variable-correlation.html"><a href="variable-correlation.html#variable-correlation-1"><i class="fa fa-check"></i><b>6.2</b> Variable correlation</a></li>
<li class="chapter" data-level="6.3" data-path="variable-correlation.html"><a href="variable-correlation.html#variance-inflation-factor"><i class="fa fa-check"></i><b>6.3</b> Variance Inflation Factor</a></li>
<li class="chapter" data-level="6.4" data-path="shape-files.html"><a href="shape-files.html#save"><i class="fa fa-check"></i><b>6.4</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="training-and-testing-data.html"><a href="training-and-testing-data.html"><i class="fa fa-check"></i><b>7</b> Training and Testing Data</a><ul>
<li class="chapter" data-level="7.1" data-path="training-and-testing-data.html"><a href="training-and-testing-data.html#presence-traintest"><i class="fa fa-check"></i><b>7.1</b> Presence train/test</a></li>
<li class="chapter" data-level="7.2" data-path="training-and-testing-data.html"><a href="training-and-testing-data.html#background-traintest"><i class="fa fa-check"></i><b>7.2</b> Background train/test</a></li>
<li class="chapter" data-level="7.3" data-path="training-and-testing-data.html"><a href="training-and-testing-data.html#training-data"><i class="fa fa-check"></i><b>7.3</b> Training data</a></li>
<li class="chapter" data-level="7.4" data-path="training-and-testing-data.html"><a href="training-and-testing-data.html#create-many-datasets"><i class="fa fa-check"></i><b>7.4</b> Create many datasets</a></li>
<li class="chapter" data-level="7.5" data-path="shape-files.html"><a href="shape-files.html#save"><i class="fa fa-check"></i><b>7.5</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sdms-glm.html"><a href="sdms-glm.html"><i class="fa fa-check"></i><b>8</b> SDMs – GLM</a><ul>
<li class="chapter" data-level="8.1" data-path="observation-data.html"><a href="observation-data.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set-up</a></li>
<li class="chapter" data-level="8.2" data-path="sdms-glm.html"><a href="sdms-glm.html#fit-glm"><i class="fa fa-check"></i><b>8.2</b> Fit GLM</a></li>
<li class="chapter" data-level="8.3" data-path="sdms-glm.html"><a href="sdms-glm.html#predictions"><i class="fa fa-check"></i><b>8.3</b> Predictions</a></li>
<li class="chapter" data-level="8.4" data-path="sdms-glm.html"><a href="sdms-glm.html#model-evaluation"><i class="fa fa-check"></i><b>8.4</b> Model Evaluation</a></li>
<li class="chapter" data-level="8.5" data-path="sdms-glm.html"><a href="sdms-glm.html#more-glm-fits"><i class="fa fa-check"></i><b>8.5</b> More GLM fits</a></li>
<li class="chapter" data-level="8.6" data-path="sdms-glm.html"><a href="sdms-glm.html#variable-selection"><i class="fa fa-check"></i><b>8.6</b> Variable selection</a></li>
<li class="chapter" data-level="8.7" data-path="sdms-glm.html"><a href="sdms-glm.html#model-comparison"><i class="fa fa-check"></i><b>8.7</b> Model Comparison</a></li>
<li class="chapter" data-level="8.8" data-path="sdms-glm.html"><a href="sdms-glm.html#model-comparison-table-first-data-set"><i class="fa fa-check"></i><b>8.8</b> Model comparison table (first data set)</a></li>
<li class="chapter" data-level="8.9" data-path="shape-files.html"><a href="shape-files.html#save"><i class="fa fa-check"></i><b>8.9</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sdms-gam.html"><a href="sdms-gam.html"><i class="fa fa-check"></i><b>9</b> SDMs – GAM</a><ul>
<li class="chapter" data-level="9.1" data-path="observation-data.html"><a href="observation-data.html#set-up"><i class="fa fa-check"></i><b>9.1</b> Set-up</a></li>
<li class="chapter" data-level="9.2" data-path="sdms-gam.html"><a href="sdms-gam.html#fit-gam"><i class="fa fa-check"></i><b>9.2</b> Fit GAM</a></li>
<li class="chapter" data-level="9.3" data-path="sdms-gam.html"><a href="sdms-gam.html#effect-size-curves"><i class="fa fa-check"></i><b>9.3</b> Effect size curves</a></li>
<li class="chapter" data-level="9.4" data-path="sdms-gam.html"><a href="sdms-gam.html#more-gam-fits"><i class="fa fa-check"></i><b>9.4</b> More GAM fits</a></li>
<li class="chapter" data-level="9.5" data-path="sdms-glm.html"><a href="sdms-glm.html#model-comparison"><i class="fa fa-check"></i><b>9.5</b> Model Comparison</a></li>
<li class="chapter" data-level="9.6" data-path="sdms-gam.html"><a href="sdms-gam.html#aucs"><i class="fa fa-check"></i><b>9.6</b> AUCs</a></li>
<li class="chapter" data-level="9.7" data-path="sdms-gam.html"><a href="sdms-gam.html#boyce-index---spearman"><i class="fa fa-check"></i><b>9.7</b> Boyce Index - Spearman</a></li>
<li class="chapter" data-level="9.8" data-path="sdms-gam.html"><a href="sdms-gam.html#hubbard-brook-comparisons"><i class="fa fa-check"></i><b>9.8</b> Hubbard Brook comparisons</a></li>
<li class="chapter" data-level="9.9" data-path="sdms-glm.html"><a href="sdms-glm.html#model-comparison-table-first-data-set"><i class="fa fa-check"></i><b>9.9</b> Model comparison table (first data set)</a></li>
<li class="chapter" data-level="9.10" data-path="shape-files.html"><a href="shape-files.html#save"><i class="fa fa-check"></i><b>9.10</b> Save</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SDMs - Trillium Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sdms-glm" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> SDMs – GLM</h1>
<p>In a linear regression, we look to explain the value of a response variable with a linear combination of our explanatory variables. For example,</p>
<p><span class="math display">\[y = \alpha + \beta_1 x_1 + \beta_2 x_2 + \epsilon\]</span></p>
<p>In the case of the presence/background SDM, our observations are 0 or 1. We do logistic regression and our <span class="math inline">\(y\)</span> is the probability of an observation (probability of ‘success’ aka a 1). We are trying to find a set of variables and <span class="math inline">\(\beta\)</span>s where cells with 1s are predicted to have high probability of observation and cells with no observations have low probability. Keep in mind that we are using background, not actually absences (0s).</p>
<p>It’s important when doing this kind of analysis to not have too much correlation between your explanatory variables. We already dealt with selecting a set of uncorrelated variables in the chapter on variable correlation, but we’ll see a couple more approaches in this chapter too.</p>
<div id="set-up" class="section level2">
<h2><span class="header-section-number">8.1</span> Set-up</h2>
<p>This chapter will use the following libraries.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="sdms-glm.html#cb110-1"></a><span class="kw">library</span>(biomod2)</span>
<span id="cb110-2"><a href="sdms-glm.html#cb110-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb110-3"><a href="sdms-glm.html#cb110-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb110-4"><a href="sdms-glm.html#cb110-4"></a><span class="kw">library</span>(ecospat)</span>
<span id="cb110-5"><a href="sdms-glm.html#cb110-5"></a><span class="kw">library</span>(sp)</span>
<span id="cb110-6"><a href="sdms-glm.html#cb110-6"></a><span class="kw">library</span>(raster)</span></code></pre></div>
<div id="load-the-data" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Load the data</h3>
<p>Load the shapefiles, Trillium data and variables raster stack created earlier.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="sdms-glm.html#cb111-1"></a><span class="co"># The VT, NH and HB outlines</span></span>
<span id="cb111-2"><a href="sdms-glm.html#cb111-2"></a><span class="kw">load</span>(<span class="st">&quot;data/shapefiles.RData&quot;</span>)</span>
<span id="cb111-3"><a href="sdms-glm.html#cb111-3"></a></span>
<span id="cb111-4"><a href="sdms-glm.html#cb111-4"></a><span class="co"># The original observation data lat/lon</span></span>
<span id="cb111-5"><a href="sdms-glm.html#cb111-5"></a><span class="kw">load</span>(<span class="st">&quot;data/trillium_presences.RData&quot;</span>)</span>
<span id="cb111-6"><a href="sdms-glm.html#cb111-6"></a></span>
<span id="cb111-7"><a href="sdms-glm.html#cb111-7"></a><span class="co"># All the data needed to fit the SDM The grid cells with</span></span>
<span id="cb111-8"><a href="sdms-glm.html#cb111-8"></a><span class="co"># presences and background grid cells w predictors The</span></span>
<span id="cb111-9"><a href="sdms-glm.html#cb111-9"></a><span class="co"># variables that I&#39;ll use for various models</span></span>
<span id="cb111-10"><a href="sdms-glm.html#cb111-10"></a><span class="kw">load</span>(<span class="st">&quot;data/sdm_data.RData&quot;</span>)</span>
<span id="cb111-11"><a href="sdms-glm.html#cb111-11"></a><span class="co"># Raster of all predictors</span></span>
<span id="cb111-12"><a href="sdms-glm.html#cb111-12"></a>allVars &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">brick</span>(<span class="st">&quot;data/allVars.grd&quot;</span>)</span></code></pre></div>
</div>
<div id="first-dataset" class="section level3">
<h3><span class="header-section-number">8.1.2</span> First dataset</h3>
<p>For this first fit, I will use the first dataset in my training/test list.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="sdms-glm.html#cb112-1"></a>traindat &lt;-<span class="st"> </span>traindatlist[[<span class="dv">1</span>]]<span class="op">$</span>traindat</span>
<span id="cb112-2"><a href="sdms-glm.html#cb112-2"></a>pres_test &lt;-<span class="st"> </span>traindatlist[[<span class="dv">1</span>]]<span class="op">$</span>pres_test</span>
<span id="cb112-3"><a href="sdms-glm.html#cb112-3"></a>backg_test &lt;-<span class="st"> </span>traindatlist[[<span class="dv">1</span>]]<span class="op">$</span>backg_test</span></code></pre></div>
</div>
<div id="model-list" class="section level3">
<h3><span class="header-section-number">8.1.3</span> Model list</h3>
<p>I will store my fits to a list so that I can easily compare them.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="sdms-glm.html#cb113-1"></a>modellist &lt;-<span class="st"> </span><span class="kw">list</span>()</span></code></pre></div>
</div>
</div>
<div id="fit-glm" class="section level2">
<h2><span class="header-section-number">8.2</span> Fit GLM</h2>
<p>Fit a generalized linear model with all the environmental variables.</p>
<ul>
<li><code>pa ~ .</code> is a model formula. To the left of <code>~</code> is the response, in this case presence/absence.</li>
<li>To the right of <code>~</code> are the predictor variables. <code>.</code> is saying use all variables in the data. To use that shortcut, I need to pass in a data frame with only <code>pa</code> (my response variable) and the predictor variables that I want to use. Thus for the environmental variables model, I pass in <code>traindat[,c("pa", envvars)]</code> which is a data frame with <code>pa</code> and <code>envvars</code> selected.</li>
<li><code>binomial(link = "logit")</code> is what we specify for logistic regression (modeling 0/1 data).</li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="sdms-glm.html#cb114-1"></a>fit &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">glm</span>(<span class="dt">formula =</span> pa <span class="op">~</span><span class="st"> </span>., <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb114-2"><a href="sdms-glm.html#cb114-2"></a>    <span class="dt">data =</span> traindat[, <span class="kw">c</span>(<span class="st">&quot;pa&quot;</span>, envvars)])</span></code></pre></div>
<p>Save to my model list.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="sdms-glm.html#cb115-1"></a>modellist[[<span class="st">&quot;glmEnv&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model =</span> fit, <span class="dt">name =</span> <span class="st">&quot;glmEnv&quot;</span>, <span class="dt">desc =</span> <span class="st">&quot;GLM - environmental variables&quot;</span>, </span>
<span id="cb115-2"><a href="sdms-glm.html#cb115-2"></a>    <span class="dt">terms =</span> envvars)</span></code></pre></div>
</div>
<div id="predictions" class="section level2">
<h2><span class="header-section-number">8.3</span> Predictions</h2>
<p>To plot predictions, use the <code>predict()</code> function. We need to pass in the raster stack of the predictor variables and the model. I want to use <code>type=response</code> in order to get the probabilities (which is what a binomial fit returns).</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="sdms-glm.html#cb116-1"></a>pm &lt;-<span class="st"> </span><span class="kw">predict</span>(allVars, fit, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p>Now we can plot the prediction.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="sdms-glm.html#cb117-1"></a><span class="kw">plot</span>(pm)</span>
<span id="cb117-2"><a href="sdms-glm.html#cb117-2"></a><span class="kw">plot</span>(nhvtshp, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-99-1.png" width="80%" style="display: block; margin: auto;" />
Because I will be making similar plots, I will make a function for my plots so they all look the same.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="sdms-glm.html#cb118-1"></a>pm.plot &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">scale.min =</span> <span class="dv">0</span>, <span class="dt">scale.max =</span> <span class="dv">1</span>, </span>
<span id="cb118-2"><a href="sdms-glm.html#cb118-2"></a>    ..., <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>)) {</span>
<span id="cb118-3"><a href="sdms-glm.html#cb118-3"></a>    <span class="kw">par</span>(<span class="dt">mar =</span> mar)</span>
<span id="cb118-4"><a href="sdms-glm.html#cb118-4"></a>    <span class="kw">plot</span>(x, <span class="dt">main =</span> main, <span class="dt">breaks =</span> <span class="kw">seq</span>(scale.min, scale.max, (scale.max <span class="op">-</span><span class="st"> </span></span>
<span id="cb118-5"><a href="sdms-glm.html#cb118-5"></a><span class="st">        </span>scale.min)<span class="op">/</span><span class="dv">10</span>), <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">terrain.colors</span>(<span class="dv">11</span>)), <span class="dt">xlab =</span> <span class="st">&quot;Longitude&quot;</span>, </span>
<span id="cb118-6"><a href="sdms-glm.html#cb118-6"></a>        <span class="dt">ylab =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.75</span>, ...)</span>
<span id="cb118-7"><a href="sdms-glm.html#cb118-7"></a>    <span class="kw">plot</span>(nhvtshp, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb118-8"><a href="sdms-glm.html#cb118-8"></a>    <span class="kw">plot</span>(hbshp, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb118-9"><a href="sdms-glm.html#cb118-9"></a>}</span></code></pre></div>
<p>Now make the prediction plot with this function.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="sdms-glm.html#cb119-1"></a><span class="kw">pm.plot</span>(pm, <span class="dt">main =</span> <span class="st">&quot;Environmental Variables&quot;</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-101-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Let’s zoom in on Hubbard Brook.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="sdms-glm.html#cb120-1"></a>xlims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">71.9</span>, <span class="fl">-71.6</span>)</span>
<span id="cb120-2"><a href="sdms-glm.html#cb120-2"></a>ylims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">43.875</span>, <span class="dv">44</span>)</span>
<span id="cb120-3"><a href="sdms-glm.html#cb120-3"></a><span class="kw">pm.plot</span>(pm, <span class="dt">main =</span> <span class="st">&quot;Environmental Variables&quot;</span>, <span class="dt">xlim =</span> xlims, <span class="dt">ylim =</span> ylims, </span>
<span id="cb120-4"><a href="sdms-glm.html#cb120-4"></a>    <span class="dt">scale.max =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-102-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="model-evaluation" class="section level2">
<h2><span class="header-section-number">8.4</span> Model Evaluation</h2>
<div id="auc-curves" class="section level3">
<h3><span class="header-section-number">8.4.1</span> AUC Curves</h3>
<p>This is a plot of how well the model predicts presence and background in the test data (so not the data you used to fit the model). A value of 0.5 is random. Values closer to 1 mean the model predicts better than random. 0.7 would be a mediocre model. This metric is sensitive to what you choose as background and how much background points you have.</p>
<p>The <code>dismo::evaluate()</code> function will calculate this metric for us. It needs the presence and background test data and the model fit.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sdms-glm.html#cb121-1"></a>erf &lt;-<span class="st"> </span>dismo<span class="op">::</span><span class="kw">evaluate</span>(pres_test, backg_test, <span class="dt">model =</span> fit)</span>
<span id="cb121-2"><a href="sdms-glm.html#cb121-2"></a><span class="kw">plot</span>(erf, <span class="st">&quot;ROC&quot;</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-103-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="boyce-index" class="section level3">
<h3><span class="header-section-number">8.4.2</span> Boyce Index</h3>
<p>The Boyce Index looks just at the presence data. We want this curve to go steadily up from left to right. The <code>ecospat::ecospat.boyce()</code> computes this metric.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="sdms-glm.html#cb122-1"></a><span class="kw">predict</span>(allVars, fit, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb122-2"><a href="sdms-glm.html#cb122-2"></a>ecospat<span class="op">::</span><span class="kw">ecospat.boyce</span>(pm, <span class="kw">cbind</span>(pres_test<span class="op">$</span>lon, pres_test<span class="op">$</span>lat))</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-104-1.png" width="80%" style="display: block; margin: auto;" />
Our model with environmental variables is ok (it goes up as x increases).</p>
</div>
<div id="response-curves" class="section level3">
<h3><span class="header-section-number">8.4.3</span> Response curves</h3>
<p>This shows the relationship between the preditor variable and the probability of presence.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sdms-glm.html#cb123-1"></a>rp &lt;-<span class="st"> </span>biomod2<span class="op">::</span><span class="kw">response.plot2</span>(<span class="dt">models =</span> <span class="kw">c</span>(<span class="st">&quot;fit&quot;</span>), <span class="dt">Data =</span> traindat, </span>
<span id="cb123-2"><a href="sdms-glm.html#cb123-2"></a>    <span class="dt">show.variables =</span> envvars, <span class="dt">fixed.var.metric =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">use.formal.names =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>Warning in which.max(sum_level): NAs introduced by coercion</code></pre>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-105-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Since <code>rp</code> is a data frame in long form, we can also use ggplot to plot.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="sdms-glm.html#cb125-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(rp, <span class="kw">aes</span>(<span class="dt">x =</span> expl.val, <span class="dt">y =</span> pred.val, <span class="dt">lty =</span> pred.name)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb125-2"><a href="sdms-glm.html#cb125-2"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;prob of occ&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>expl.name, </span>
<span id="cb125-3"><a href="sdms-glm.html#cb125-3"></a>    <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Environmental variables&quot;</span>)</span>
<span id="cb125-4"><a href="sdms-glm.html#cb125-4"></a>p</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-106-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="variable-importance" class="section level3">
<h3><span class="header-section-number">8.4.4</span> Variable importance</h3>
<p>Let’s look at the variable importance. This is a measure of how much each variable singly impacts the fit.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="sdms-glm.html#cb126-1"></a>varimp &lt;-<span class="st"> </span>biomod2<span class="op">::</span><span class="kw">variables_importance</span>(fit, <span class="dt">data =</span> traindat)<span class="op">$</span>mat</span>
<span id="cb126-2"><a href="sdms-glm.html#cb126-2"></a>varimp[varimp <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.01</span>, ]</span></code></pre></div>
<pre><code>temp.diurnal.range   temp.seasonality    precip.warm.qtr    precip.cold.qtr 
          0.030525           0.353842           1.000000           0.079967 </code></pre>
</div>
</div>
<div id="more-glm-fits" class="section level2">
<h2><span class="header-section-number">8.5</span> More GLM fits</h2>
<p>Now I repeat the model fitting code for the other sets of variables and store to my model list. Careful, this is not memory efficient and <code>modellist</code> will be large. I am doing this for convenience since my region is not too big. If I had a big region, the model objects would be large and I would need to be careful with memory.</p>
<div id="topography-only" class="section level3">
<h3><span class="header-section-number">8.5.1</span> Topography only</h3>
<p>This is the model with just topography.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="sdms-glm.html#cb128-1"></a>vars &lt;-<span class="st"> </span>topovars</span>
<span id="cb128-2"><a href="sdms-glm.html#cb128-2"></a>vars</span></code></pre></div>
<pre><code>[1] &quot;elevation&quot; &quot;slope&quot;     &quot;aspect&quot;   </code></pre>
<p>The only change is that the data are now <code>traindat[,c("pa", vars)]</code> with <code>vars=topovars</code>.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="sdms-glm.html#cb130-1"></a>fit &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">glm</span>(<span class="dt">formula =</span> pa <span class="op">~</span><span class="st"> </span>., <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb130-2"><a href="sdms-glm.html#cb130-2"></a>    <span class="dt">data =</span> traindat[, <span class="kw">c</span>(<span class="st">&quot;pa&quot;</span>, vars)])</span>
<span id="cb130-3"><a href="sdms-glm.html#cb130-3"></a>modellist[[<span class="st">&quot;glmTopo&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model =</span> fit, <span class="dt">name =</span> <span class="st">&quot;glmTopo&quot;</span>, </span>
<span id="cb130-4"><a href="sdms-glm.html#cb130-4"></a>    <span class="dt">desc =</span> <span class="st">&quot;GLM - topographical variables&quot;</span>, <span class="dt">terms =</span> vars)</span></code></pre></div>
</div>
<div id="tree-cover-only" class="section level3">
<h3><span class="header-section-number">8.5.2</span> Tree Cover only</h3>
<p>This is the model with tree cover and a few environmental variables.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="sdms-glm.html#cb131-1"></a>vars &lt;-<span class="st"> </span>lcvars</span>
<span id="cb131-2"><a href="sdms-glm.html#cb131-2"></a>vars</span></code></pre></div>
<pre><code>[1] &quot;Tree.Cover&quot;      &quot;mean.temp&quot;       &quot;precip.warm.qtr&quot;</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="sdms-glm.html#cb133-1"></a>fit &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">glm</span>(<span class="dt">formula =</span> pa <span class="op">~</span><span class="st"> </span>., <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb133-2"><a href="sdms-glm.html#cb133-2"></a>    <span class="dt">data =</span> traindat[, <span class="kw">c</span>(<span class="st">&quot;pa&quot;</span>, vars)])</span>
<span id="cb133-3"><a href="sdms-glm.html#cb133-3"></a>modellist[[<span class="st">&quot;glmLC&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model =</span> fit, <span class="dt">name =</span> <span class="st">&quot;glmLC&quot;</span>, <span class="dt">desc =</span> <span class="st">&quot;GLM - LC variables&quot;</span>, </span>
<span id="cb133-4"><a href="sdms-glm.html#cb133-4"></a>    <span class="dt">terms =</span> vars)</span></code></pre></div>
</div>
<div id="vif-variables" class="section level3">
<h3><span class="header-section-number">8.5.3</span> VIF variables</h3>
<p>These were variables selected by the Variance Inflation step search function.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="sdms-glm.html#cb134-1"></a>vars &lt;-<span class="st"> </span>vifvars</span>
<span id="cb134-2"><a href="sdms-glm.html#cb134-2"></a>vars</span></code></pre></div>
<pre><code> [1] &quot;temp.diurnal.range&quot;        &quot;temp.seasonality&quot;         
 [3] &quot;mean.temp.warm.qtr&quot;        &quot;precip.seasonality&quot;       
 [5] &quot;precip.warm.qtr&quot;           &quot;precip.cold.qtr&quot;          
 [7] &quot;slope&quot;                     &quot;aspect&quot;                   
 [9] &quot;Evergreen.Broadleaf.Trees&quot; &quot;Mixed.Other.Trees&quot;        
[11] &quot;Shrubs&quot;                    &quot;Herbaceous&quot;               
[13] &quot;Cultivated&quot;                &quot;Flooded&quot;                  
[15] &quot;Urban&quot;                     &quot;Water&quot;                    </code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="sdms-glm.html#cb136-1"></a>fit &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">glm</span>(<span class="dt">formula =</span> pa <span class="op">~</span><span class="st"> </span>., <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb136-2"><a href="sdms-glm.html#cb136-2"></a>    <span class="dt">data =</span> traindat[, <span class="kw">c</span>(<span class="st">&quot;pa&quot;</span>, vars)])</span></code></pre></div>
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="sdms-glm.html#cb138-1"></a>modellist[[<span class="st">&quot;glmVIF&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model =</span> fit, <span class="dt">name =</span> <span class="st">&quot;glmVIF&quot;</span>, <span class="dt">desc =</span> <span class="st">&quot;GLM - all VIF variables&quot;</span>, </span>
<span id="cb138-2"><a href="sdms-glm.html#cb138-2"></a>    <span class="dt">terms =</span> vars)</span></code></pre></div>
</div>
<div id="small-set-of-environmental-variables" class="section level3">
<h3><span class="header-section-number">8.5.4</span> Small set of environmental variables</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="sdms-glm.html#cb139-1"></a>vars &lt;-<span class="st"> </span>minEnvVars</span>
<span id="cb139-2"><a href="sdms-glm.html#cb139-2"></a>vars</span></code></pre></div>
<pre><code>[1] &quot;precip.warm.qtr&quot;    &quot;mean.temp&quot;          &quot;temp.diurnal.range&quot;</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="sdms-glm.html#cb141-1"></a>fit &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">glm</span>(<span class="dt">formula =</span> pa <span class="op">~</span><span class="st"> </span>., <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb141-2"><a href="sdms-glm.html#cb141-2"></a>    <span class="dt">data =</span> traindat[, <span class="kw">c</span>(<span class="st">&quot;pa&quot;</span>, vars)])</span>
<span id="cb141-3"><a href="sdms-glm.html#cb141-3"></a>modellist[[<span class="st">&quot;glmMinEnv&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model =</span> fit, <span class="dt">name =</span> <span class="st">&quot;glmMinEnv&quot;</span>, </span>
<span id="cb141-4"><a href="sdms-glm.html#cb141-4"></a>    <span class="dt">desc =</span> <span class="st">&quot;GLM - minimal environmental variables&quot;</span>, <span class="dt">terms =</span> vars)</span></code></pre></div>
</div>
</div>
<div id="variable-selection" class="section level2">
<h2><span class="header-section-number">8.6</span> Variable selection</h2>
<p>The model with the VIF variables still has a lot of variables.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="sdms-glm.html#cb142-1"></a>vifvars</span></code></pre></div>
<pre><code> [1] &quot;temp.diurnal.range&quot;        &quot;temp.seasonality&quot;         
 [3] &quot;mean.temp.warm.qtr&quot;        &quot;precip.seasonality&quot;       
 [5] &quot;precip.warm.qtr&quot;           &quot;precip.cold.qtr&quot;          
 [7] &quot;slope&quot;                     &quot;aspect&quot;                   
 [9] &quot;Evergreen.Broadleaf.Trees&quot; &quot;Mixed.Other.Trees&quot;        
[11] &quot;Shrubs&quot;                    &quot;Herbaceous&quot;               
[13] &quot;Cultivated&quot;                &quot;Flooded&quot;                  
[15] &quot;Urban&quot;                     &quot;Water&quot;                    </code></pre>
<p>Let’s try stepwise variable selection using AIC as criteria.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="sdms-glm.html#cb144-1"></a>glmStart &lt;-<span class="st"> </span><span class="kw">glm</span>(pa <span class="op">~</span><span class="st"> </span>., <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), <span class="dt">data =</span> traindat[, </span>
<span id="cb144-2"><a href="sdms-glm.html#cb144-2"></a>    <span class="kw">c</span>(<span class="st">&quot;pa&quot;</span>, vifvars)])</span>
<span id="cb144-3"><a href="sdms-glm.html#cb144-3"></a>glmStep &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">stepAIC</span>(<span class="dt">object =</span> glmStart, <span class="dt">scope =</span> pa <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> traindat[, </span>
<span id="cb144-4"><a href="sdms-glm.html#cb144-4"></a>    <span class="kw">c</span>(<span class="st">&quot;pa&quot;</span>, vifvars)], <span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="dt">trace =</span> <span class="dv">-1</span>, <span class="dt">k =</span> <span class="dv">2</span>, </span>
<span id="cb144-5"><a href="sdms-glm.html#cb144-5"></a>    <span class="dt">control =</span> <span class="kw">glm.control</span>(<span class="dt">maxit =</span> <span class="dv">500</span>))</span>
<span id="cb144-6"><a href="sdms-glm.html#cb144-6"></a><span class="co"># Save</span></span>
<span id="cb144-7"><a href="sdms-glm.html#cb144-7"></a>modellist[[<span class="st">&quot;glmStep&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model =</span> glmStep, <span class="dt">name =</span> <span class="st">&quot;glmStep&quot;</span>, </span>
<span id="cb144-8"><a href="sdms-glm.html#cb144-8"></a>    <span class="dt">desc =</span> <span class="st">&quot;GLM - variables selected w step AIC&quot;</span>, <span class="dt">terms =</span> <span class="kw">attr</span>(glmStep<span class="op">$</span>terms, </span>
<span id="cb144-9"><a href="sdms-glm.html#cb144-9"></a>        <span class="st">&quot;term.labels&quot;</span>))</span></code></pre></div>
<p>This model has fewer terms:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="sdms-glm.html#cb145-1"></a><span class="kw">attr</span>(glmStep<span class="op">$</span>terms, <span class="st">&quot;term.labels&quot;</span>)</span></code></pre></div>
<pre><code> [1] &quot;temp.seasonality&quot;   &quot;mean.temp.warm.qtr&quot; &quot;precip.seasonality&quot;
 [4] &quot;precip.warm.qtr&quot;    &quot;precip.cold.qtr&quot;    &quot;slope&quot;             
 [7] &quot;Mixed.Other.Trees&quot;  &quot;Shrubs&quot;             &quot;Herbaceous&quot;        
[10] &quot;Cultivated&quot;        </code></pre>
</div>
<div id="model-comparison" class="section level2">
<h2><span class="header-section-number">8.7</span> Model Comparison</h2>
<div id="aic" class="section level3">
<h3><span class="header-section-number">8.7.1</span> AIC</h3>
<p>AIC is a measure of model fit penalized by how many parameters are being fit. It is a model fit metric that helps you not overfit a model (use too many parameters). Smaller AIC is better. The actual value is unimportant rather you compare AICs within a set. Things to keep in mind.</p>
<ul>
<li>The data must be identical in the models being compared.</li>
<li>Best not to compare AICs from different functions unless you are sure they are showing the same values. Some functions drop a constant, since only differences between models matter. But if you are comparing AICs from models fit with different functions, it critical that the constant is not dropped. This is less of a problem now as function writers are more careful, but just be aware.</li>
</ul>
<p>Here are the AICs so far. <code>lapply</code> means apply a function to all objects in a list. <code>AIC()</code> is the function that returns the AIC for a model.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="sdms-glm.html#cb147-1"></a><span class="kw">sort</span>(<span class="kw">unlist</span>(<span class="kw">lapply</span>(modellist, <span class="cf">function</span>(x) {</span>
<span id="cb147-2"><a href="sdms-glm.html#cb147-2"></a>    <span class="kw">AIC</span>(x<span class="op">$</span>model)</span>
<span id="cb147-3"><a href="sdms-glm.html#cb147-3"></a>})))</span></code></pre></div>
<pre><code>  glmStep    glmVIF     glmLC    glmEnv glmMinEnv   glmTopo 
 2668.134  2677.802  2729.548  2763.459  2791.425  2798.976 </code></pre>
</div>
<div id="auc-curves-1" class="section level3">
<h3><span class="header-section-number">8.7.2</span> AUC curves</h3>
<p>First I’ll make a data frame.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="sdms-glm.html#cb149-1"></a>dfb &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">model =</span> <span class="ot">NULL</span>)</span>
<span id="cb149-2"><a href="sdms-glm.html#cb149-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">names</span>(modellist)) {</span>
<span id="cb149-3"><a href="sdms-glm.html#cb149-3"></a>    erf &lt;-<span class="st"> </span>dismo<span class="op">::</span><span class="kw">evaluate</span>(pres_test, backg_test, <span class="dt">model =</span> modellist[[i]]<span class="op">$</span>model)</span>
<span id="cb149-4"><a href="sdms-glm.html#cb149-4"></a>    a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> erf<span class="op">@</span>FPR, <span class="dt">y =</span> erf<span class="op">@</span>TPR, <span class="dt">model =</span> i, <span class="dt">title =</span> <span class="kw">paste0</span>(i, </span>
<span id="cb149-5"><a href="sdms-glm.html#cb149-5"></a>        <span class="st">&quot; AUC=&quot;</span>, <span class="kw">round</span>(erf<span class="op">@</span>auc, <span class="dt">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb149-6"><a href="sdms-glm.html#cb149-6"></a>    dfb &lt;-<span class="st"> </span><span class="kw">rbind</span>(dfb, a)</span>
<span id="cb149-7"><a href="sdms-glm.html#cb149-7"></a>}</span></code></pre></div>
<p>Now I can use that data frame with ggplot.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="sdms-glm.html#cb150-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dfb, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb150-2"><a href="sdms-glm.html#cb150-2"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;True positive rate&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;False positive rate&quot;</span>)</span>
<span id="cb150-3"><a href="sdms-glm.html#cb150-3"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>title) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Evaluation of the false/positive performance&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb150-4"><a href="sdms-glm.html#cb150-4"></a><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-121-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="boyce-index-1" class="section level3">
<h3><span class="header-section-number">8.7.3</span> Boyce Index</h3>
<p>Let’s check model quality using the Boyce Index. First I will add the index to all my model lists. Since I am doing model predictions, I’ll save that to a raster stack for plotting later. This takes a long time, so I skip if I’ve already added the index to the list.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="sdms-glm.html#cb151-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">names</span>(modellist)) {</span>
<span id="cb151-2"><a href="sdms-glm.html#cb151-2"></a>    pm &lt;-<span class="st"> </span><span class="kw">predict</span>(allVars, modellist[[i]]<span class="op">$</span>model, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb151-3"><a href="sdms-glm.html#cb151-3"></a>    <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(modellist)[<span class="dv">1</span>]) </span>
<span id="cb151-4"><a href="sdms-glm.html#cb151-4"></a>        pm.stack &lt;-<span class="st"> </span>pm <span class="cf">else</span> pm.stack &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">stack</span>(pm.stack, pm)</span>
<span id="cb151-5"><a href="sdms-glm.html#cb151-5"></a>    <span class="cf">if</span> (<span class="st">&quot;bindex&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(modellist[[i]])) </span>
<span id="cb151-6"><a href="sdms-glm.html#cb151-6"></a>        <span class="cf">next</span></span>
<span id="cb151-7"><a href="sdms-glm.html#cb151-7"></a>    bindex &lt;-<span class="st"> </span>ecospat<span class="op">::</span><span class="kw">ecospat.boyce</span>(pm, <span class="kw">cbind</span>(pres_test<span class="op">$</span>lon, </span>
<span id="cb151-8"><a href="sdms-glm.html#cb151-8"></a>        pres_test<span class="op">$</span>lat), <span class="dt">PEplot =</span> <span class="ot">FALSE</span>)</span>
<span id="cb151-9"><a href="sdms-glm.html#cb151-9"></a>    modellist[[i]]<span class="op">$</span>bindex &lt;-<span class="st"> </span>bindex</span>
<span id="cb151-10"><a href="sdms-glm.html#cb151-10"></a>}</span>
<span id="cb151-11"><a href="sdms-glm.html#cb151-11"></a><span class="kw">names</span>(pm.stack) &lt;-<span class="st"> </span><span class="kw">names</span>(modellist)</span></code></pre></div>
<p>Then I’ll make a data frame.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="sdms-glm.html#cb152-1"></a>dfb &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">model =</span> <span class="ot">NULL</span>)</span>
<span id="cb152-2"><a href="sdms-glm.html#cb152-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">names</span>(modellist)) {</span>
<span id="cb152-3"><a href="sdms-glm.html#cb152-3"></a>    bi &lt;-<span class="st"> </span>modellist[[i]]<span class="op">$</span>bindex</span>
<span id="cb152-4"><a href="sdms-glm.html#cb152-4"></a>    a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">y =</span> bi<span class="op">$</span>F.ratio, <span class="dt">x =</span> bi<span class="op">$</span>HS, <span class="dt">model =</span> i)</span>
<span id="cb152-5"><a href="sdms-glm.html#cb152-5"></a>    dfb &lt;-<span class="st"> </span><span class="kw">rbind</span>(dfb, a)</span>
<span id="cb152-6"><a href="sdms-glm.html#cb152-6"></a>}</span>
<span id="cb152-7"><a href="sdms-glm.html#cb152-7"></a>dfb<span class="op">$</span>observed &lt;-<span class="st"> &quot;yes&quot;</span></span>
<span id="cb152-8"><a href="sdms-glm.html#cb152-8"></a>dfb<span class="op">$</span>observed[dfb<span class="op">$</span>y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> &quot;no&quot;</span></span></code></pre></div>
<p>Now I can use that data frame with ggplot.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="sdms-glm.html#cb153-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dfb, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col =</span> observed)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb153-2"><a href="sdms-glm.html#cb153-2"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Boyce Index&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Suitability&quot;</span>)</span>
<span id="cb153-3"><a href="sdms-glm.html#cb153-3"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>model) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Evaluation of the test data performance&quot;</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-124-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="response-curves-1" class="section level3">
<h3><span class="header-section-number">8.7.4</span> Response curves</h3>
<p>We can compare the response curves for models which have the same variables.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="sdms-glm.html#cb154-1"></a>glmEnv &lt;-<span class="st"> </span>modellist[[<span class="st">&quot;glmEnv&quot;</span>]]<span class="op">$</span>model</span>
<span id="cb154-2"><a href="sdms-glm.html#cb154-2"></a>glmLC &lt;-<span class="st"> </span>modellist[[<span class="st">&quot;glmLC&quot;</span>]]<span class="op">$</span>model</span>
<span id="cb154-3"><a href="sdms-glm.html#cb154-3"></a>rp &lt;-<span class="st"> </span>biomod2<span class="op">::</span><span class="kw">response.plot2</span>(<span class="dt">models =</span> <span class="kw">c</span>(<span class="st">&quot;glmEnv&quot;</span>, <span class="st">&quot;glmLC&quot;</span>), </span>
<span id="cb154-4"><a href="sdms-glm.html#cb154-4"></a>    <span class="dt">Data =</span> traindat, <span class="dt">show.variables =</span> envvars, <span class="dt">fixed.var.metric =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb154-5"><a href="sdms-glm.html#cb154-5"></a>    <span class="dt">plot =</span> <span class="ot">FALSE</span>, <span class="dt">use.formal.names =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>Warning in which.max(sum_level): NAs introduced by coercion</code></pre>
<p>The models don’have all the variables. I will put NAs if the model doesn’t have that variable.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="sdms-glm.html#cb156-1"></a>rp<span class="op">$</span>include &lt;-<span class="st"> </span><span class="kw">apply</span>(rp, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb156-2"><a href="sdms-glm.html#cb156-2"></a>    x[<span class="dv">2</span>] <span class="op">%in%</span><span class="st"> </span>modellist[[x[<span class="dv">4</span>]]]<span class="op">$</span>terms</span>
<span id="cb156-3"><a href="sdms-glm.html#cb156-3"></a>})</span>
<span id="cb156-4"><a href="sdms-glm.html#cb156-4"></a>rp<span class="op">$</span>pred.val[<span class="op">!</span>rp<span class="op">$</span>include] &lt;-<span class="st"> </span><span class="ot">NA</span></span></code></pre></div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="sdms-glm.html#cb157-1"></a>gg.rp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(rp, <span class="kw">aes</span>(<span class="dt">x =</span> expl.val, <span class="dt">y =</span> pred.val, <span class="dt">col =</span> pred.name)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb157-2"><a href="sdms-glm.html#cb157-2"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;prob of occ&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb157-3"><a href="sdms-glm.html#cb157-3"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>expl.name, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Environmental variables&quot;</span>)</span>
<span id="cb157-4"><a href="sdms-glm.html#cb157-4"></a><span class="kw">print</span>(gg.rp)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-127-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="predictions-1" class="section level3">
<h3><span class="header-section-number">8.7.5</span> Predictions</h3>
<p>Unfortunately when it plots a stack, the border shapes don’t show up.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="sdms-glm.html#cb158-1"></a><span class="kw">pm.plot</span>(pm.stack, <span class="dt">main =</span> <span class="kw">names</span>(pm.stack))</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-128-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Let’s zoom in on Hubbard Brook.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="sdms-glm.html#cb159-1"></a>xlims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">71.9</span>, <span class="fl">-71.6</span>)</span>
<span id="cb159-2"><a href="sdms-glm.html#cb159-2"></a>ylims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">43.875</span>, <span class="dv">44</span>)</span>
<span id="cb159-3"><a href="sdms-glm.html#cb159-3"></a><span class="kw">pm.plot</span>(pm.stack, <span class="dt">main =</span> <span class="kw">names</span>(pm.stack), <span class="dt">xlim =</span> xlims, <span class="dt">ylim =</span> ylims, </span>
<span id="cb159-4"><a href="sdms-glm.html#cb159-4"></a>    <span class="dt">scale.max =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="sdm-demo_files/figure-html/unnamed-chunk-129-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="model-comparison-table-first-data-set" class="section level2">
<h2><span class="header-section-number">8.8</span> Model comparison table (first data set)</h2>
<p>Compare AICs, Spearman Correlation for the models with the first data set (in <code>traindatlist</code>).</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="sdms-glm.html#cb160-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">name =</span> <span class="kw">unlist</span>(<span class="kw">lapply</span>(modellist, <span class="cf">function</span>(x) {</span>
<span id="cb160-2"><a href="sdms-glm.html#cb160-2"></a>    x<span class="op">$</span>name</span>
<span id="cb160-3"><a href="sdms-glm.html#cb160-3"></a>})), <span class="dt">Spearman =</span> <span class="kw">unlist</span>(<span class="kw">lapply</span>(modellist, <span class="cf">function</span>(x) {</span>
<span id="cb160-4"><a href="sdms-glm.html#cb160-4"></a>    x<span class="op">$</span>bindex<span class="op">$</span>Spearman.cor</span>
<span id="cb160-5"><a href="sdms-glm.html#cb160-5"></a>})), <span class="dt">AUC =</span> <span class="kw">unlist</span>(<span class="kw">lapply</span>(modellist, <span class="cf">function</span>(x) {</span>
<span id="cb160-6"><a href="sdms-glm.html#cb160-6"></a>    dismo<span class="op">::</span><span class="kw">evaluate</span>(pres_test, backg_test, <span class="dt">model =</span> x<span class="op">$</span>model)<span class="op">@</span>auc</span>
<span id="cb160-7"><a href="sdms-glm.html#cb160-7"></a>})), <span class="dt">AIC =</span> <span class="kw">unlist</span>(<span class="kw">lapply</span>(modellist, <span class="cf">function</span>(x) {</span>
<span id="cb160-8"><a href="sdms-glm.html#cb160-8"></a>    <span class="kw">AIC</span>(x<span class="op">$</span>model)</span>
<span id="cb160-9"><a href="sdms-glm.html#cb160-9"></a>})))</span>
<span id="cb160-10"><a href="sdms-glm.html#cb160-10"></a>df<span class="op">$</span>delAIC &lt;-<span class="st"> </span>df<span class="op">$</span>AIC <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(df<span class="op">$</span>AIC)</span>
<span id="cb160-11"><a href="sdms-glm.html#cb160-11"></a>df &lt;-<span class="st"> </span>df[<span class="kw">order</span>(df<span class="op">$</span>AIC), ]</span>
<span id="cb160-12"><a href="sdms-glm.html#cb160-12"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">Spearman</th>
<th align="right">AUC</th>
<th align="right">AIC</th>
<th align="right">delAIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">glmStep</td>
<td align="right">0.956</td>
<td align="right">0.7396198</td>
<td align="right">2668.134</td>
<td align="right">0.000000</td>
</tr>
<tr class="even">
<td align="left">glmVIF</td>
<td align="right">0.957</td>
<td align="right">0.7400992</td>
<td align="right">2677.802</td>
<td align="right">9.668267</td>
</tr>
<tr class="odd">
<td align="left">glmLC</td>
<td align="right">0.901</td>
<td align="right">0.7164793</td>
<td align="right">2729.548</td>
<td align="right">61.414438</td>
</tr>
<tr class="even">
<td align="left">glmEnv</td>
<td align="right">0.823</td>
<td align="right">0.7246033</td>
<td align="right">2763.459</td>
<td align="right">95.325415</td>
</tr>
<tr class="odd">
<td align="left">glmMinEnv</td>
<td align="right">0.881</td>
<td align="right">0.6973802</td>
<td align="right">2791.425</td>
<td align="right">123.290818</td>
</tr>
<tr class="even">
<td align="left">glmTopo</td>
<td align="right">0.863</td>
<td align="right">0.7244628</td>
<td align="right">2798.976</td>
<td align="right">130.842026</td>
</tr>
</tbody>
</table>
</div>
<div id="save" class="section level2">
<h2><span class="header-section-number">8.9</span> Save</h2>
<p>Save so I can use for the next chapter on GAMs. I will also save the function I made for plotting.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="sdms-glm.html#cb161-1"></a><span class="kw">save</span>(pm.plot, modellist, <span class="dt">file =</span> <span class="st">&quot;modellist.RData&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="training-and-testing-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sdms-gam.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/eeholmes/Species-Dist-Modeling---Trillium/edit/master/08_GLM.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["sdm-demo.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
